# 待办事项清单

**更新时间:** 2025-10-07
**项目版本:** v1.2.0.4

---

## 🔴 高优先级 (本周完成)

### 1. 文档整理 ✅ 进行中
**预计时间:** 3-5小时
**状态:** 80%完成

- [x] 创建文档目录结构
- [x] 编写文档导航 (`docs/README.md`)
- [x] 编写系统架构文档 (`ARCHITECTURE.md`)
- [x] 编写API参考文档 (`API_REFERENCE.md`)
- [x] 编写云服务配置文档 (`CLOUD_SERVICES.md`)
- [x] 编写已完成清单 (`COMPLETED_TASKS.md`)
- [x] 编写待办清单 (`TODO_LIST.md`)
- [ ] 编写项目路线图 (`ROADMAP.md`)
- [ ] 整理功能文档到 `docs/功能文档/`
- [ ] 更新 `.gitignore` (排除敏感文件)

**优先原因:**
- 为未来开发提供清晰指引
- 便于回忆项目细节
- 方便团队协作

---

### 2. 敏感信息记录 (不提交Git) ⏰ 30分钟
**状态:** 待开始

创建 `docs/部署文档/SERVER_CREDENTIALS.md`:
- [ ] SSH密钥位置和备份
- [ ] 数据库密码
- [ ] OSS AccessKey
- [ ] JWT密钥
- [ ] 域名注册商信息
- [ ] 紧急联系方式

⚠️ **重要:** 此文件包含敏感信息，必须添加到 `.gitignore`

---

## 🟡 中优先级 (本月完成)

### 3. 用户账号密码管理功能 ⏰ 1-2天
**状态:** 待开发

**功能描述:**
- 添加修改密码功能（当前只有注册功能）
- 注册功能优化：移除邀请码要求（已实现）
- 添加用户说明：非伊利系统人员账号将不定期失效

**任务:**
- [ ] 设计密码修改界面
- [ ] 实现密码修改API接口 `PUT /api/auth/change_password`
- [ ] 添加密码强度验证
- [ ] 注册页面添加用户协议说明
  - "⚠️ 注意：如果您不是伊利系统人员，账号可能会不定期失效"
- [ ] 测试密码修改流程

**优先原因:**
- 用户基本功能完善
- 提升用户体验
- 明确账号使用范围

---

### 4. 选配结果推送功能 ⏰ 2-3天
**状态:** 需求确认中

**功能描述:**
- 选配完成后推送结果到牧场管理系统
- 添加 `result_farm_code` 字段标识牧场

**任务:**
- [ ] 需求调研：确认牧场系统接口
- [ ] 数据库设计：`mating_results` 表结构
- [ ] API设计：`POST /api/data/mating_result`
- [ ] 客户端实现：推送功能集成
- [ ] 测试：与牧场系统对接测试
- [ ] 日志记录：`report_push_logs` 表

**预期价值:**
- 自动化数据流转
- 减少人工操作
- 提高数据时效性

---

### 5. GitHub Actions OSS自动上传 ✅ 已完成
**状态:** 已完成 (2025-10-28)

**任务:**
- [x] 在GitHub仓库配置Secrets
  - `ALIYUN_ACCESS_KEY_ID`
  - `ALIYUN_ACCESS_KEY_SECRET`
- [x] 修改 `.github/workflows/build-releases.yml`
  - 添加OSS上传步骤
  - 自动更新 `latest/version.json`
  - 配置正确的OSS路径结构
- [x] 测试自动上传流程
- [x] 编写开发指南文档

**优势:**
- 发布新版本自动上传OSS
- 减少手动操作

---

### 6. 数据质量改进 ⏰ 3-5天
**状态:** 规划中

#### 6.1 体型外貌鉴定模块重构
- [ ] 分析现有代码
- [ ] 优化计算逻辑
- [ ] 改进数据验证
- [ ] 单元测试

#### 6.2 缺陷性状分析
- [ ] 增加更多缺陷基因检测
- [ ] 优化缺陷标记逻辑
- [ ] 改进用户提示

#### 6.3 Excel报告开发 ⏰ 12-15天
**状态:** 进行中
**参考文档:** `docs/功能文档/Excel报告生成实施方案_v1.2.md`

**已完成 (Sheet 1-7):**
- [x] Sheet 1: 牧场基础信息 ✅
- [x] Sheet 1A: 牧场牛群原始数据 ✅
- [x] Sheet 2: 系谱识别分析 ✅
- [x] Sheet 2明细: 全群母牛系谱识别明细 ✅
- [x] Sheet 3: 育种性状分析（4个子sheet）✅
- [x] Sheet 4: 母牛指数分析（2个子sheet）✅
- [x] Sheet 5: 配种记录-隐性基因分析 ✅ 2025-10-28
- [x] Sheet 6: 配种记录-近交系数分析 ✅ 2025-10-28
- [x] Sheet 7: 配种记录明细 ✅ 2025-10-28

**进行中 (Sheet 8-11):**
- [ ] Sheet 8: 已用公牛性状汇总分析 🔄 设计中
- [ ] Sheet 9: 已用公牛性状明细
- [ ] Sheet 10: 备选公牛排名
- [ ] Sheet 11: 选配推荐结果

---

### 7. 部署文档整合 ⏰ 2-3小时
**状态:** 待开始

**任务:**
- [ ] 创建统一的部署指南 (`DEPLOYMENT_GUIDE.md`)
- [ ] 合并以下文档内容：
  - `部署说明.md`
  - `server_setup_guide.md`
  - `deployment/README.md`
  - `deployment/server-setup.md`
- [ ] 添加故障排查章节 (`TROUBLESHOOTING.md`)
- [ ] 清理重复文档

---

## 🟢 低优先级 (项目后期)

### 7. 安全加固 ⏰ 2-3天

#### 7.1 移除数据库密码硬编码
- [ ] 使用环境变量管理数据库密码
- [ ] 创建配置文件模板 (`.env.example`)
- [ ] 更新部署文档

#### 7.2 更强的JWT密钥
- [ ] 生成32位随机密钥
- [ ] 配置密钥轮换机制
- [ ] 更新API服务配置

#### 7.3 API认证加固
- [ ] 缺失公牛上传接口添加认证 (可选)
- [ ] API限流机制 (防止滥用)
- [ ] 访问日志审计

#### 7.4 定期密钥轮换
- [ ] 设计密钥轮换策略
- [ ] 自动化轮换脚本
- [ ] 通知机制

---

### 8. 性能优化 ⏰ 3-5天

#### 8.1 数据库优化
- [ ] 索引优化 (NAAB号、品种字段)
- [ ] 查询性能分析
- [ ] 慢查询日志分析
- [ ] 数据库连接池优化

#### 8.2 API缓存策略
- [ ] Redis缓存集成
- [ ] 版本信息缓存
- [ ] 公牛数据缓存

#### 8.3 前端资源优化
- [ ] 图片压缩
- [ ] 资源懒加载
- [ ] 启动速度优化

#### 8.4 OSS CDN启用
- [ ] 阿里云CDN配置
- [ ] 自定义加速域名
- [ ] 缓存策略设置

---

### 9. 代码质量提升 ⏰ 5-7天

#### 9.1 单元测试
- [ ] pytest环境搭建
- [ ] 核心模块测试覆盖
  - 数据处理模块
  - 育种计算模块
  - API客户端模块
- [ ] 测试覆盖率目标: 70%

#### 9.2 代码重构
- [ ] 重复代码提取
- [ ] 函数拆分优化
- [ ] 模块职责划分
- [ ] 设计模式应用

#### 9.3 类型注解
- [ ] 函数参数类型注解
- [ ] 返回值类型注解
- [ ] mypy类型检查

#### 9.4 代码规范
- [ ] black代码格式化
- [ ] flake8代码检查
- [ ] 统一命名规范
- [ ] 文档字符串完善

---

### 10. 用户体验优化 ⏰ 2-3天

#### 10.1 帮助文档
- [ ] 应用内帮助系统
- [ ] 操作视频教程
- [ ] 常见问题FAQ
- [ ] 在线帮助文档网站

#### 10.2 错误提示优化
- [ ] 错误信息本地化
- [ ] 更友好的错误提示
- [ ] 错误自动上报

#### 10.3 性能监控面板
- [ ] 应用性能监控
- [ ] 计算时间统计
- [ ] 内存使用监控

---

## 🔮 未来规划 (待评估)

### 11. 功能扩展

#### 11.1 移动端应用
- [ ] 技术选型 (React Native / Flutter)
- [ ] 核心功能移植
- [ ] UI/UX设计
- [ ] 跨平台测试

#### 11.2 Web版本
- [ ] 技术选型 (Vue.js / React)
- [ ] 后端API完善
- [ ] 前端开发
- [ ] 部署上线

#### 11.3 数据分析看板
- [ ] 数据可视化设计
- [ ] 统计分析功能
- [ ] 报表生成系统

#### 11.4 AI辅助选配
- [ ] 机器学习模型训练
- [ ] 历史数据分析
- [ ] 智能推荐算法
- [ ] 效果评估

#### 11.5 批量选配优化
- [ ] 大规模数据处理
- [ ] 分布式计算
- [ ] 任务队列管理

---

### 12. 系统集成

#### 12.1 牧场管理系统对接
- [ ] API接口对接
- [ ] 数据格式转换
- [ ] 双向数据同步
- [ ] 错误处理机制

#### 12.2 第三方数据源接入
- [ ] 外部公牛库数据
- [ ] 行业标准数据
- [ ] 实时更新机制

#### 12.3 云备份系统
- [ ] 自动备份策略
- [ ] 数据恢复机制
- [ ] 备份监控告警

#### 12.4 多牧场数据汇总
- [ ] 多租户架构
- [ ] 数据隔离机制
- [ ] 权限管理系统

---

## ⏸️ 暂缓任务

### 13. 完全API化改造
**原因:** 当前架构已够用，OSS下载性能优异

- [ ] 移除所有数据库直连代码
- [ ] 删除 `config/db_config.py`
- [ ] 统一通过API访问数据
- [ ] API性能优化

**重新评估条件:**
- 用户量大幅增加
- 需要更细粒度的权限控制
- 需要实时数据同步

---

## ✅ 近期完成

### 2025-10-07
- [x] API地址统一 (`https://api.genepop.com`)
- [x] 缺失公牛上传优化（上传时即刻检查）
- [x] 用户提示简化（移除技术细节）
- [x] 数据库版本显示（侧边栏）
- [x] 文档整理启动

### 2025-09-30
- [x] 发布 v1.2.0.4 版本
- [x] 格式错误NAAB号保留处理
- [x] 弹窗合并和简化

### 2025-09-22
- [x] 数据库更新到 v1.2.2 (247,192条记录)

---

## 📊 任务优先级矩阵

```
重要且紧急:
  - 文档整理 ✅
  - 敏感信息记录

重要不紧急:
  - 选配结果推送
  - 安全加固
  - 代码质量提升

紧急不重要:
  - GitHub Actions优化
  - 部署文档整合

不重要不紧急:
  - 完全API化改造
  - 移动端应用
```

---

## 🎯 本月目标 (2025-10)

1. ✅ 完成文档整理
2. 配置OSS自动上传
3. 启动选配结果推送功能开发
4. 完成安全加固计划

---

## 📝 任务认领

| 任务 | 负责人 | 状态 | 截止日期 |
|------|--------|------|----------|
| 文档整理 | - | 进行中 | 2025-10-08 |
| 选配结果推送 | - | 待开始 | 2025-10-31 |
| OSS自动上传 | - | 待开始 | 2025-10-15 |
| 安全加固 | - | 待评估 | - |

---

**参考:** [COMPLETED_TASKS.md](COMPLETED_TASKS.md) 查看已完成工作

**最后更新:** 2025-10-07
