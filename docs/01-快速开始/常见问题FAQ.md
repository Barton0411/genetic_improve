# 常见问题FAQ

**更新时间:** 2025-11-02
**适用版本:** v1.2.0.14+

---

## 📋 目录

1. [登录和账号](#登录和账号)
2. [数据上传](#数据上传)
3. [选配计算](#选配计算)
4. [报告生成](#报告生成)
5. [系统设置](#系统设置)
6. [错误排查](#错误排查)

---

## 登录和账号

### Q1: 如何获取邀请码？

**A:** 联系系统管理员或伊利公司负责人获取邀请码。每个邀请码只能使用一次。

---

### Q2: 忘记密码怎么办？

**A:** 目前暂不支持自助重置密码，请联系管理员重置。

**临时解决方案:**
1. 联系管理员提供用户名
2. 管理员后台重置密码
3. 使用新密码登录
4. 登录后立即修改密码

---

### Q3: 可以同时在多台电脑上登录吗？

**A:** 可以。同一账号可以在多台设备上登录，但建议：
- 避免同时操作同一个项目（可能导致数据冲突）
- 使用项目备份功能定期备份

---

## 数据上传

### Q4: 上传数据时提示"格式错误"怎么办？

**A:** 常见原因和解决方法：

**原因1: Excel版本不兼容**
- 使用Excel 2016+打开模板
- 另存为 `.xlsx` 格式
- 避免使用 `.xls` 或 `.csv` 格式

**原因2: 列名不匹配**
- 使用系统提供的模板
- 不要修改模板的列名（第一行表头）
- 不要插入或删除列

**原因3: 数据类型错误**
- 日期列使用日期格式（如2024-01-15）
- 数值列不要包含文字
- 母牛号、公牛号不要包含特殊字符

---

### Q5: 上传的母牛数据中有些公牛号找不到怎么办？

**A:** 系统会自动处理：

1. **自动上传云端**
   - 系统自动将缺失公牛号上传到云端记录表
   - 管理员会定期补充这些公牛数据

2. **用户操作**
   - 点击"数据管理" → "更新本地数据库"
   - 等待1-2天后重新更新数据库
   - 或联系管理员添加该公牛数据

3. **临时影响**
   - 缺失公牛的遗传数据无法使用
   - 相关母牛的选配推荐可能不完整

详见：[缺失公牛上传功能指南](../02-用户手册/01-数据管理/缺失公牛上传功能指南.md)

---

### Q6: 如何判断数据上传是否成功？

**A:** 检查以下几点：

✅ **数据文件**
- 项目文件夹/数据文件/ 中有对应的Excel文件

✅ **处理结果**
- 项目文件夹/处理结果/ 中生成了对应的processed文件

✅ **系统提示**
- 上传完成后显示"数据处理完成"
- 无红色错误提示

✅ **预览检查**
- 在"数据管理"中查看数据预览
- 确认母牛数量、公牛数量正确

---

## 选配计算

### Q7: 为什么有些母牛的选配位是空的？

**A:** 可能原因：

**原因1: 近交系数超标**
- 所有可选公牛都会导致后代近交系数超过阈值（默认3.125%）
- **解决**: 在"设置"中适当放宽近交系数阈值（如调整到6.25%）

**原因2: 隐性基因风险**
- 所有可选公牛都与母牛父亲携带相同隐性基因
- **解决**: 在"设置"中关闭隐性基因控制（不推荐）

**原因3: 库存耗尽**
- 该类型冻精库存已用完
- **解决**: 增加公牛库存，或调整分组策略

详见：[选配功能完整指南 - 常见问题](../02-用户手册/03-选配推荐/选配功能完整指南.md#常见问题)

---

### Q8: 如何调整A/B/C组的划分比例？

**A:** 修改策略表配置：

1. 进入"设置" → "选配参数" → "策略表配置"
2. 修改各组占比（确保总和为100%）
3. 调整各组的配种方法序列
4. 保存设置

**示例:**
```
A组: 30% - ["性控", "性控", "常规", "常规"]
B组: 40% - ["性控", "常规", "常规", "常规"]
C组: 30% - ["常规", "常规", "常规", "常规"]
```

---

### Q9: 1选分配为什么不完全按库存比例？

**A:** 最小分配保证机制：

为避免小库存公牛完全无法使用，系统确保：
- 库存>0的公牛至少分配1头（1选时）
- 有助于测试新引进公牛的配种效果

**示例:**
```
库存：A=1000, B=10, C=1，共100头母牛

不保证：A=99头，B=1头，C=0头
保证后：A=98头，B=1头，C=1头 ← C公牛确保有1头
```

---

### Q10: 选配计算需要多长时间？

**A:** 取决于数据规模：

| 母牛数量 | 公牛数量 | 预计时间 |
|---------|---------|---------|
| < 500 | < 30 | 1-2分钟 |
| 500-1000 | 30-50 | 2-5分钟 |
| 1000-2000 | 50-100 | 5-10分钟 |
| > 2000 | > 100 | 10-20分钟 |

**优化建议:**
- 关闭其他程序释放内存
- 不要同时打开多个项目
- 定期清理项目文件（删除不需要的旧报告）

---

## 报告生成

### Q11: Excel报告生成失败怎么办？

**A:** 常见原因和解决方法：

**原因1: 缺少数据**
- 检查是否完成了所有必需的数据上传
- 必需数据：母牛信息、系谱信息、备选公牛

**原因2: 内存不足**
- 关闭其他Excel文件和程序
- 重启软件后重试

**原因3: Excel文件被占用**
- 关闭所有Excel程序
- 确保报告文件没有被其他程序打开

---

### Q12: 报告中的某些Sheet是空的？

**A:** 检查数据依赖：

Excel报告的17个Sheet有不同的数据依赖，部分Sheet需要特定数据：

| Sheet | 必需数据 |
|-------|---------|
| 1-4 | 母牛信息、系谱信息 |
| 5-8 | 母牛信息、母牛性状数据 |
| 9-10 | 母牛指数计算结果 |
| 11-13 | 配种记录 |
| 14-15 | 配种记录 + 公牛库 |
| 16 | 备选公牛数据 |
| 17 | 选配推荐结果 |

详见：[Excel报告生成指南 - 数据流程](../02-用户手册/04-报告生成/Excel报告生成指南.md#数据流程)

---

### Q13: 报告中的图表显示异常？

**A:** 建议使用以下软件打开：

✅ **推荐:**
- Microsoft Excel 2016+
- WPS Office

⚠️ **部分支持:**
- LibreOffice Calc（部分图表可能显示异常）
- Google Sheets（不推荐，图表兼容性差）

---

## 系统设置

### Q14: 如何修改近交系数阈值？

**A:** 步骤：

1. 进入"设置" → "选配参数"
2. 找到"近交系数阈值"
3. 输入新值（如6.25表示6.25%）
4. 点击"保存"

**常用阈值:**
- 3.125% (1/32) - 严格控制（默认）
- 6.25% (1/16) - 中等控制
- 12.5% (1/8) - 宽松控制

**建议:**
- 新建群体：使用3.125%
- 成熟群体：可放宽到6.25%
- 特殊情况：咨询育种专家

---

### Q15: 如何备份项目数据？

**A:** 两种方法：

**方法1: 自动备份（推荐）**
1. 进入"设置" → "系统参数"
2. 开启"自动备份"
3. 系统每次操作后自动保存
4. 保留最近7天的备份

**方法2: 手动备份**
1. 找到项目文件夹位置
2. 复制整个项目文件夹
3. 保存到其他位置（U盘、云盘等）

**备份频率建议:**
- 重要数据：每天备份
- 一般数据：每周备份
- 长期存档：每月备份到云盘

---

## 错误排查

### Q16: 软件启动时崩溃怎么办？

**A:** 排查步骤：

**步骤1: 检查系统要求**
- Windows 10/11 (64位) 或 macOS 11+
- 8GB+ 内存
- 2GB+ 可用硬盘空间

**步骤2: 清理配置文件**
```
Windows: 删除 C:\Users\[用户名]\.genetic_improve\config.json
macOS: 删除 /Users/[用户名]/.genetic_improve/config.json
```
重新启动软件会自动生成新配置

**步骤3: 重新安装**
1. 卸载软件
2. 删除安装目录
3. 重新下载最新版本安装

**步骤4: 联系技术支持**
提供以下信息：
- 操作系统版本
- 软件版本号
- 错误截图或日志文件

---

### Q17: 无法连接网络怎么办？

**A:** 检查以下几点：

**检查1: 网络连接**
```bash
ping api.genepop.com
```
如果无法ping通，检查网络设置

**检查2: 防火墙设置**
- Windows: 允许 `genetic_improve.exe` 访问网络
- macOS: 系统偏好设置 → 安全性与隐私 → 防火墙 → 允许该应用

**检查3: 代理设置**
- 如果公司使用代理，在"设置"中配置代理
- 或暂时关闭代理重试

**检查4: SSL证书**
```bash
curl -I https://api.genepop.com/api/health
```
如果显示SSL错误，可能需要更新系统证书

---

### Q18: 数据库更新失败？

**A:** 可能原因和解决：

**原因1: 磁盘空间不足**
- 确保至少有2GB可用空间
- 清理不需要的文件

**原因2: 网络不稳定**
- 使用有线网络代替无线
- 避免在网络高峰期更新
- 如下载中断，重新点击"更新数据库"（支持断点续传）

**原因3: 权限问题**
- Windows: 以管理员身份运行软件
- macOS: 确保软件有文件写入权限

---

### Q19: Excel报告打开后格式错乱？

**A:** 可能原因：

**原因1: Excel版本过旧**
- 使用 Excel 2016 或更高版本
- 或使用 WPS Office

**原因2: 区域设置问题**
- 系统区域设置为"中国"
- 日期格式设置为"YYYY-MM-DD"

**原因3: 文件损坏**
- 重新生成报告
- 如果问题持续，联系技术支持

---

### Q20: 如何获取技术支持？

**A:** 多种方式：

**联系团队:**
- 📧 **技术支持**: jaybzwang@163.com（王波臻 - 开发负责人）
- 📧 **运维反馈**: yangchaoqun1@yili.com（杨超群 - 运维人员）
- 📱 **电话**: 17367077554（杨超群）
- 🌐 **在线文档**: https://docs.genepop.com

**提交问题时请提供:**
1. 软件版本号（帮助 → 关于）
2. 操作系统版本
3. 详细的问题描述
4. 错误截图或日志文件
5. 操作步骤（如何重现问题）

**响应时间:**
- 工作日: 4小时内响应
- 周末/节假日: 24小时内响应

---

## 💡 更多帮助

找不到您的问题？

- 查看 [用户手册](../02-用户手册/README.md) 获取详细功能说明
- 访问 [开发文档](../03-开发文档/README.md) 了解技术细节
- 联系技术支持获取一对一帮助

---

**文档持续更新中...**

如果您有其他常见问题，欢迎反馈！
