# Excelç»¼åˆæŠ¥å‘Šç”Ÿæˆå®æ–½æ–¹æ¡ˆ v1.1

**æ–‡æ¡£ç‰ˆæœ¬:** v1.1
**åˆ›å»ºæ—¶é—´:** 2025-10-07
**åŸºäºéœ€æ±‚:** ExcelæŠ¥å‘Šæœ€ç»ˆéœ€æ±‚.md v1.1
**çŠ¶æ€:** å‡†å¤‡å¼€å‘

---

## ğŸ“‹ å®æ–½å†³ç­–

### 1. å›¾è¡¨åµŒå…¥ç­–ç•¥ âœ… å·²ç¡®å®š

**æ–¹æ¡ˆï¼š** æ ¸å¿ƒå›¾è¡¨åµŒå…¥

| Sheet | å›¾è¡¨ç±»å‹ | æ˜¯å¦åµŒå…¥ | åŸå›  |
|------|---------|---------|------|
| Sheet 1 | æˆæ¯ç‰›/åå¤‡ç‰›å æ¯”é¥¼å›¾ | âœ… åµŒå…¥ | â­v1.1æ–°å¢ åŸºç¡€ä¿¡æ¯å¯è§†åŒ– |
| Sheet 1 | æŒ‰èƒæ¬¡åˆ†å¸ƒé¥¼å›¾ | âœ… åµŒå…¥ | â­v1.1æ–°å¢ ç‰›ç¾¤ç»“æ„å±•ç¤º |
| Sheet 2 | ç³»è°±è¯†åˆ«é¥¼å›¾Ã—3 | âœ… åµŒå…¥ | çˆ¶å·/å¤–ç¥–çˆ¶/å¤–æ›¾å¤–ç¥–çˆ¶è¯†åˆ«ç‡ |
| Sheet 3 | NM$åˆ†å¸ƒå›¾ | âœ… åµŒå…¥ | æŸ±çŠ¶å›¾+é¥¼å›¾ |
| Sheet 3 | TPIåˆ†å¸ƒå›¾ | âœ… åµŒå…¥ | æŸ±çŠ¶å›¾+é¥¼å›¾ |
| Sheet 3 | NM$æ­£æ€åˆ†å¸ƒ | âœ… åµŒå…¥ | æ ¸å¿ƒè‚²ç§æŒ‡æ ‡ |
| Sheet 3 | TPIæ­£æ€åˆ†å¸ƒ | âœ… åµŒå…¥ | æ ¸å¿ƒè‚²ç§æŒ‡æ ‡ |
| Sheet 3 | è‚²ç§æŒ‡æ•°æ­£æ€åˆ†å¸ƒ | âœ… åµŒå…¥ | â­v1.1æ–°å¢ æ ¸å¿ƒæŒ‡æ ‡ |
| Sheet 3 | æ€§çŠ¶è¿›å±•æŠ˜çº¿å›¾ | âœ… åµŒå…¥ | å«å¯¹æ¯”ç‰§åœºæ•°æ®å åŠ  â­v1.1ä¿®æ”¹ |
| Sheet 4 | å†»ç²¾ä½¿ç”¨çƒ­åŠ›å›¾ | âŒ ä¸åµŒå…¥ | æ•°æ®é‡å¤§ï¼Œæä¾›æ•°æ®å³å¯ |

**é¢„è®¡æ–‡ä»¶å¤§å°ï¼š** 2-5MBï¼ˆå®Œæ•´ç‰ˆï¼‰

### 2. æŠ¥å‘Šç‰ˆæœ¬ç­–ç•¥ âœ… v1.1å·²ç®€åŒ–

**æ–¹æ¡ˆï¼š** åªç”Ÿæˆå®Œæ•´ç‰ˆï¼ˆå–æ¶ˆç²¾ç®€ç‰ˆï¼‰â­v1.1ä¿®æ”¹

**åŒ…å«å†…å®¹ï¼š**
- âœ… æ‰€æœ‰æ±‡æ€»è¡¨
- âœ… æ‰€æœ‰æ˜ç»†è¡¨
- âœ… æ‰€æœ‰åµŒå…¥å›¾è¡¨
- âœ… 9ä¸ªSheetï¼ˆSheet 1-8 + Sheet 7Aï¼‰

**UIè®¾è®¡ï¼š**
```
[ç”ŸæˆExcelç»¼åˆæŠ¥å‘Š]  ï¼ˆå•ä¸€æŒ‰é’®ï¼Œç›´æ¥ç”Ÿæˆå®Œæ•´ç‰ˆï¼‰
```

### 3. å¤šç‰§åœºå¯¹æ¯”æ¨¡æ¿ âœ… v1.1å·²ç®€åŒ–

**æ¨¡æ¿æ–‡ä»¶åï¼š** `å¤šç‰§åœºå¯¹æ¯”æ•°æ®æ¨¡æ¿.xlsx`

**æ¨¡æ¿æ ¼å¼ï¼ˆä»…å¯¹æ¯”ç‰§åœºæ€§çŠ¶æ˜ç»†è¡¨ï¼‰ï¼š** â­v1.1ä¿®æ”¹

| ç‰§åœºåç§° | ç‰›ç¾¤è§„æ¨¡ | å¹³å‡NM$ | å¹³å‡TPI | å¹³å‡äº§å¥¶ | å¹³å‡ä¹³è„‚ç‡ | å¹³å‡ä¹³è›‹ç™½ç‡ | ... (å…¶ä»–æ€§çŠ¶) |
|---------|---------|---------|---------|---------|-----------|-----------|--------------|
| å¯¹æ¯”ç‰§åœºA | 1200 | 450 | 2350 | 12500 | 3.80 | 3.20 | ... |
| å¯¹æ¯”ç‰§åœºB | 800 | 420 | 2280 | 12000 | 3.90 | 3.30 | ... |

**æ ¡éªŒè§„åˆ™ï¼š**
- ç‰§åœºåç§°ä¸èƒ½ä¸ºç©º
- NM$ã€TPIã€äº§å¥¶å¿…é¡»ä¸ºæ•°å­—
- ä¹³è„‚ç‡ã€ä¹³è›‹ç™½ç‡èŒƒå›´ï¼š2.0-6.0%
- æœ€å¤šæ”¯æŒå¯¼å…¥10ä¸ªå¯¹æ¯”ç‰§åœº

---

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### æ ¸å¿ƒåº“é€‰æ‹©

**ä½¿ç”¨ openpyxl**
```bash
pip install openpyxl pandas numpy matplotlib scipy
```

**åŸå› ï¼š**
- å®Œæ•´æ”¯æŒ .xlsx æ ¼å¼
- æ”¯æŒæ ·å¼ã€æ¡ä»¶æ ¼å¼ã€å›¾è¡¨
- çº¯Pythonå®ç°ï¼Œè·¨å¹³å°
- ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„

### é¡¹ç›®ç»“æ„

```
core/
â”œâ”€â”€ excel_report/                     # ExcelæŠ¥å‘Šç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ generator.py                  # ä¸»ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ data_collectors/              # æ•°æ®æ”¶é›†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ farm_info_collector.py   # Sheet 1
â”‚   â”‚   â”œâ”€â”€ pedigree_collector.py    # Sheet 2
â”‚   â”‚   â”œâ”€â”€ traits_collector.py      # Sheet 3
â”‚   â”‚   â”œâ”€â”€ bull_usage_collector.py  # Sheet 4
â”‚   â”‚   â”œâ”€â”€ gene_collector.py        # Sheet 5
â”‚   â”‚   â”œâ”€â”€ inbreeding_collector.py  # Sheet 6
â”‚   â”‚   â”œâ”€â”€ bull_ranking_collector.py # Sheet 7
â”‚   â”‚   â”œâ”€â”€ bull_prediction_collector.py # Sheet 7A â­v1.1æ–°å¢
â”‚   â”‚   â””â”€â”€ mating_collector.py      # Sheet 8
â”‚   â”œâ”€â”€ sheet_builders/               # Sheetæ„å»ºæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base_builder.py          # åŸºç±»
â”‚   â”‚   â”œâ”€â”€ sheet1_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet2_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet3_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet4_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet5_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet6_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet7_builder.py
â”‚   â”‚   â”œâ”€â”€ sheet7a_builder.py       # â­v1.1æ–°å¢
â”‚   â”‚   â””â”€â”€ sheet8_builder.py
â”‚   â”œâ”€â”€ formatters/                   # æ ¼å¼åŒ–æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ style_manager.py         # æ ·å¼ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ conditional_format.py    # æ¡ä»¶æ ¼å¼
â”‚   â”‚   â””â”€â”€ chart_builder.py         # å›¾è¡¨æ„å»º
â”‚   â””â”€â”€ utils/                        # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ data_validator.py        # æ•°æ®æ ¡éªŒ
â”‚       â””â”€â”€ file_checker.py          # æ–‡ä»¶æ£€æŸ¥
```

### æ•°æ®æµç¨‹

```
ç”¨æˆ·ç‚¹å‡»æŒ‰é’®
    â†“
ExcelReportGenerator.generate()
    â†“
æ£€æŸ¥å¿…è¦æ–‡ä»¶ (file_checker)
    â†“
æ”¶é›†æ‰€æœ‰æ•°æ® (data_collectors)
    â†“
æŒ‰é¡ºåºç”Ÿæˆ9ä¸ªSheet (sheet_builders)
    â†“
åº”ç”¨æ ¼å¼åŒ– (formatters)
    â†“
åµŒå…¥å›¾è¡¨ (chart_builder)
    â†“
ä¿å­˜æ–‡ä»¶
    â†“
æç¤ºç”¨æˆ·
```

---

## ğŸ“Š æ ¸å¿ƒç±»è®¾è®¡

### 1. ExcelReportGenerator (ä¸»ç”Ÿæˆå™¨)

```python
# core/excel_report/generator.py

from pathlib import Path
from openpyxl import Workbook
import logging
from datetime import datetime

logger = logging.getLogger(__name__)

class ExcelReportGenerator:
    """Excelç»¼åˆæŠ¥å‘Šç”Ÿæˆå™¨ v1.1"""

    def __init__(self, project_folder: Path):
        """
        åˆå§‹åŒ–ç”Ÿæˆå™¨

        Args:
            project_folder: é¡¹ç›®æ–‡ä»¶å¤¹è·¯å¾„
        """
        self.project_folder = project_folder
        self.analysis_folder = project_folder / "åˆ†æç»“æœ"

        # åˆå§‹åŒ–workbook
        self.wb = Workbook()
        self.wb.remove(self.wb.active)  # åˆ é™¤é»˜è®¤sheet

        # æ ·å¼ç®¡ç†å™¨
        from .formatters import StyleManager
        self.style_manager = StyleManager()

        # å›¾è¡¨æ„å»ºå™¨
        from .formatters import ChartBuilder
        self.chart_builder = ChartBuilder()

    def generate(self) -> tuple[bool, str]:
        """
        ç”ŸæˆExcelæŠ¥å‘Šï¼ˆå®Œæ•´ç‰ˆï¼‰

        Returns:
            (æˆåŠŸæ ‡å¿—, æ–‡ä»¶è·¯å¾„æˆ–é”™è¯¯æ¶ˆæ¯)
        """
        try:
            logger.info("å¼€å§‹ç”ŸæˆExcelç»¼åˆæŠ¥å‘Š v1.1")

            # 1. æ£€æŸ¥æ•°æ®æ–‡ä»¶
            from .utils import FileChecker
            checker = FileChecker(self.analysis_folder)
            missing_files = checker.check_required_files()
            if missing_files:
                return False, f"ç¼ºå°‘å¿…è¦æ–‡ä»¶ï¼š{', '.join(missing_files)}"

            # 2. æ”¶é›†æ‰€æœ‰æ•°æ®
            logger.info("æ”¶é›†æ•°æ®...")
            data = self._collect_all_data()

            # 3. ç”Ÿæˆ9ä¸ªSheet
            logger.info("ç”ŸæˆSheet 1: ç‰§åœºåŸºç¡€ä¿¡æ¯")
            self._build_sheet1(data['farm_info'])

            logger.info("ç”ŸæˆSheet 2: ç³»è°±è¯†åˆ«åˆ†æ")
            self._build_sheet2(data['pedigree'])

            logger.info("ç”ŸæˆSheet 3: è‚²ç§æ€§çŠ¶åˆ†æ")
            self._build_sheet3(data['traits'])

            logger.info("ç”ŸæˆSheet 4: å…¬ç‰›ä½¿ç”¨åˆ†æ")
            self._build_sheet4(data['bull_usage'])

            logger.info("ç”ŸæˆSheet 5: éšæ€§åŸºå› åˆ†æ")
            self._build_sheet5(data['genes'])

            logger.info("ç”ŸæˆSheet 6: è¿‘äº¤ç³»æ•°åˆ†æ")
            self._build_sheet6(data['inbreeding'])

            logger.info("ç”ŸæˆSheet 7: å¤‡é€‰å…¬ç‰›æ’å")
            self._build_sheet7(data['bull_ranking'])

            logger.info("ç”ŸæˆSheet 7A: å¤‡é€‰å…¬ç‰›é¢„æµ‹åˆ†æ")  # â­v1.1æ–°å¢
            self._build_sheet7a(data['bull_prediction'])

            if data.get('mating'):
                logger.info("ç”ŸæˆSheet 8: é€‰é…æ¨èç»“æœ")
                self._build_sheet8(data['mating'])

            # 4. ä¿å­˜æ–‡ä»¶
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            filename = f"è‚²ç§åˆ†æç»¼åˆæŠ¥å‘Š_{timestamp}.xlsx"
            output_path = self.analysis_folder / filename

            self.wb.save(output_path)
            logger.info(f"ExcelæŠ¥å‘Šå·²ä¿å­˜: {output_path}")

            return True, str(output_path)

        except Exception as e:
            logger.error(f"ç”ŸæˆExcelæŠ¥å‘Šå¤±è´¥: {e}", exc_info=True)
            return False, str(e)

    def _collect_all_data(self) -> dict:
        """æ”¶é›†æ‰€æœ‰éœ€è¦çš„æ•°æ®"""
        from .data_collectors import (
            collect_farm_info,
            collect_pedigree_data,
            collect_traits_data,
            collect_bull_usage_data,
            collect_gene_data,
            collect_inbreeding_data,
            collect_bull_ranking_data,
            collect_bull_prediction_data,  # â­v1.1æ–°å¢
            collect_mating_data
        )

        return {
            'farm_info': collect_farm_info(self.project_folder),
            'pedigree': collect_pedigree_data(self.analysis_folder),
            'traits': collect_traits_data(self.analysis_folder, self.project_folder),
            'bull_usage': collect_bull_usage_data(self.analysis_folder),
            'genes': collect_gene_data(self.analysis_folder),
            'inbreeding': collect_inbreeding_data(self.analysis_folder),
            'bull_ranking': collect_bull_ranking_data(self.analysis_folder),
            'bull_prediction': collect_bull_prediction_data(self.analysis_folder),  # â­v1.1æ–°å¢
            'mating': collect_mating_data(self.analysis_folder)
        }

    def _build_sheet1(self, data: dict):
        """æ„å»ºSheet 1: ç‰§åœºåŸºç¡€ä¿¡æ¯"""
        from .sheet_builders import Sheet1Builder
        builder = Sheet1Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet2(self, data: dict):
        """æ„å»ºSheet 2: ç³»è°±è¯†åˆ«åˆ†æ"""
        from .sheet_builders import Sheet2Builder
        builder = Sheet2Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet3(self, data: dict):
        """æ„å»ºSheet 3: è‚²ç§æ€§çŠ¶åˆ†æ"""
        from .sheet_builders import Sheet3Builder
        builder = Sheet3Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet4(self, data: dict):
        """æ„å»ºSheet 4: å…¬ç‰›ä½¿ç”¨åˆ†æ"""
        from .sheet_builders import Sheet4Builder
        builder = Sheet4Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet5(self, data: dict):
        """æ„å»ºSheet 5: éšæ€§åŸºå› åˆ†æ"""
        from .sheet_builders import Sheet5Builder
        builder = Sheet5Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet6(self, data: dict):
        """æ„å»ºSheet 6: è¿‘äº¤ç³»æ•°åˆ†æ"""
        from .sheet_builders import Sheet6Builder
        builder = Sheet6Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet7(self, data: dict):
        """æ„å»ºSheet 7: å¤‡é€‰å…¬ç‰›æ’å"""
        from .sheet_builders import Sheet7Builder
        builder = Sheet7Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet7a(self, data: dict):
        """æ„å»ºSheet 7A: å¤‡é€‰å…¬ç‰›é¢„æµ‹åˆ†æ â­v1.1æ–°å¢"""
        from .sheet_builders import Sheet7ABuilder
        builder = Sheet7ABuilder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)

    def _build_sheet8(self, data: dict):
        """æ„å»ºSheet 8: ä¸ªä½“é€‰é…ç»“æœ"""
        from .sheet_builders import Sheet8Builder
        builder = Sheet8Builder(self.wb, self.style_manager, self.chart_builder)
        builder.build(data)
```

### 2. StyleManager (æ ·å¼ç®¡ç†å™¨)

```python
# core/excel_report/formatters/style_manager.py

from openpyxl.styles import Font, PatternFill, Alignment, Border, Side

class StyleManager:
    """ç»Ÿä¸€ç®¡ç†Excelæ ·å¼"""

    # é¢œè‰²å®šä¹‰
    COLOR_HEADER_BG = "2E5C8A"      # æ·±è“è‰²
    COLOR_HEADER_TEXT = "FFFFFF"     # ç™½è‰²
    COLOR_ROW_EVEN = "F5F5F5"        # æµ…ç°è‰²
    COLOR_TOTAL_BG = "D6E9F8"        # æµ…è“è‰²
    COLOR_RISK_HIGH = "FFE6E6"       # çº¢è‰²èƒŒæ™¯
    COLOR_RISK_MEDIUM = "FFF9E6"     # é»„è‰²èƒŒæ™¯
    COLOR_RISK_LOW = "E6F9E6"        # ç»¿è‰²èƒŒæ™¯

    def __init__(self):
        self._init_styles()

    def _init_styles(self):
        """åˆå§‹åŒ–å¸¸ç”¨æ ·å¼"""
        # æ ‡é¢˜è¡Œæ ·å¼
        self.header_font = Font(
            name='å¾®è½¯é›…é»‘',
            size=12,
            bold=True,
            color=self.COLOR_HEADER_TEXT
        )
        self.header_fill = PatternFill(
            start_color=self.COLOR_HEADER_BG,
            end_color=self.COLOR_HEADER_BG,
            fill_type='solid'
        )
        self.header_alignment = Alignment(
            horizontal='center',
            vertical='center',
            wrap_text=True
        )

        # æ•°æ®è¡Œæ ·å¼
        self.data_font = Font(name='å¾®è½¯é›…é»‘', size=10)
        self.data_alignment = Alignment(horizontal='left', vertical='center')
        self.data_alignment_center = Alignment(horizontal='center', vertical='center')
        self.data_alignment_right = Alignment(horizontal='right', vertical='center')

        # åˆè®¡è¡Œæ ·å¼
        self.total_font = Font(name='å¾®è½¯é›…é»‘', size=10, bold=True)
        self.total_fill = PatternFill(
            start_color=self.COLOR_TOTAL_BG,
            end_color=self.COLOR_TOTAL_BG,
            fill_type='solid'
        )

        # è¾¹æ¡†
        thin_border = Side(border_style="thin", color="000000")
        self.border = Border(
            left=thin_border,
            right=thin_border,
            top=thin_border,
            bottom=thin_border
        )

    def apply_header_style(self, cell):
        """åº”ç”¨æ ‡é¢˜æ ·å¼"""
        cell.font = self.header_font
        cell.fill = self.header_fill
        cell.alignment = self.header_alignment
        cell.border = self.border

    def apply_data_style(self, cell, alignment='left'):
        """åº”ç”¨æ•°æ®æ ·å¼"""
        cell.font = self.data_font
        cell.border = self.border
        if alignment == 'center':
            cell.alignment = self.data_alignment_center
        elif alignment == 'right':
            cell.alignment = self.data_alignment_right
        else:
            cell.alignment = self.data_alignment

    def apply_total_style(self, cell):
        """åº”ç”¨åˆè®¡è¡Œæ ·å¼"""
        cell.font = self.total_font
        cell.fill = self.total_fill
        cell.border = self.border
        cell.alignment = self.data_alignment_center

    def apply_risk_color(self, cell, risk_level: str):
        """åº”ç”¨é£é™©ç­‰çº§é¢œè‰²"""
        if risk_level == 'high':
            cell.fill = PatternFill(
                start_color=self.COLOR_RISK_HIGH,
                end_color=self.COLOR_RISK_HIGH,
                fill_type='solid'
            )
        elif risk_level == 'medium':
            cell.fill = PatternFill(
                start_color=self.COLOR_RISK_MEDIUM,
                end_color=self.COLOR_RISK_MEDIUM,
                fill_type='solid'
            )
        elif risk_level == 'low':
            cell.fill = PatternFill(
                start_color=self.COLOR_RISK_LOW,
                end_color=self.COLOR_RISK_LOW,
                fill_type='solid'
            )
```

### 3. BaseSheetBuilder (Sheetæ„å»ºå™¨åŸºç±»)

```python
# core/excel_report/sheet_builders/base_builder.py

from openpyxl import Workbook
from openpyxl.worksheet.worksheet import Worksheet
from abc import ABC, abstractmethod

class BaseSheetBuilder(ABC):
    """Sheetæ„å»ºå™¨åŸºç±»"""

    def __init__(self, workbook: Workbook, style_manager, chart_builder):
        self.wb = workbook
        self.style_manager = style_manager
        self.chart_builder = chart_builder
        self.ws = None

    @abstractmethod
    def build(self, data: dict):
        """æ„å»ºSheetï¼ˆå­ç±»å¿…é¡»å®ç°ï¼‰"""
        pass

    def _create_sheet(self, title: str) -> Worksheet:
        """åˆ›å»ºæ–°çš„Sheet"""
        self.ws = self.wb.create_sheet(title=title)
        return self.ws

    def _write_header(self, row: int, headers: list, start_col: int = 1):
        """å†™å…¥æ ‡é¢˜è¡Œ"""
        for col_idx, header in enumerate(headers, start=start_col):
            cell = self.ws.cell(row=row, column=col_idx, value=header)
            self.style_manager.apply_header_style(cell)

    def _write_data_row(self, row: int, values: list, start_col: int = 1, alignment='left'):
        """å†™å…¥æ•°æ®è¡Œ"""
        for col_idx, value in enumerate(values, start=start_col):
            cell = self.ws.cell(row=row, column=col_idx, value=value)
            self.style_manager.apply_data_style(cell, alignment)

    def _write_total_row(self, row: int, values: list, start_col: int = 1):
        """å†™å…¥åˆè®¡è¡Œ"""
        for col_idx, value in enumerate(values, start=start_col):
            cell = self.ws.cell(row=row, column=col_idx, value=value)
            self.style_manager.apply_total_style(cell)

    def _set_column_widths(self, widths: dict):
        """è®¾ç½®åˆ—å®½ {åˆ—å·: å®½åº¦}"""
        from openpyxl.utils import get_column_letter
        for col_idx, width in widths.items():
            col_letter = get_column_letter(col_idx)
            self.ws.column_dimensions[col_letter].width = width

    def _freeze_panes(self, cell: str):
        """å†»ç»“çª—æ ¼"""
        self.ws.freeze_panes = cell

    def _add_pie_chart(self, data: dict, position: str, title: str):
        """æ·»åŠ é¥¼å›¾"""
        return self.chart_builder.create_pie_chart(
            self.ws, data, position, title
        )

    def _add_bar_chart(self, data: dict, position: str, title: str):
        """æ·»åŠ æŸ±çŠ¶å›¾"""
        return self.chart_builder.create_bar_chart(
            self.ws, data, position, title
        )

    def _add_line_chart(self, data: dict, position: str, title: str):
        """æ·»åŠ æŠ˜çº¿å›¾"""
        return self.chart_builder.create_line_chart(
            self.ws, data, position, title
        )
```

---

## ğŸ“… å¼€å‘è®¡åˆ’

### Phase 1: åŸºç¡€æ¡†æ¶ + Sheet 1,2,8 (3å¤©)

**Day 1: æ¡†æ¶æ­å»º**
- [x] åˆ›å»ºé¡¹ç›®ç»“æ„
- [ ] å®ç° ExcelReportGenerator ä¸»ç±»
- [ ] å®ç° StyleManager
- [ ] å®ç° ChartBuilder
- [ ] å®ç° BaseSheetBuilder
- [ ] å®ç° FileChecker

**Day 2: Sheet 1**
- [ ] å®ç° farm_info_collector
- [ ] å®ç° Sheet1Builder
  - [ ] åŸºæœ¬ä¿¡æ¯
  - [ ] ç‰›ç¾¤ç»“æ„ç»Ÿè®¡
  - [ ] 2ä¸ªé¥¼å›¾ â­v1.1æ–°å¢
  - [ ] ä¸Šä¼ æ•°æ®æ¦‚è§ˆï¼ˆæ–°æ ¼å¼ï¼‰â­v1.1ä¿®æ”¹
- [ ] æµ‹è¯• Sheet 1 ç”Ÿæˆ

**Day 3: Sheet 2 & 8**
- [ ] å®ç° pedigree_collector
- [ ] å®ç° Sheet2Builder
  - [ ] æ±‡æ€»è¡¨
  - [ ] 3ä¸ªé¥¼å›¾
  - [ ] æ˜ç»†è¡¨
- [ ] å®ç° mating_collector
- [ ] å®ç° Sheet8Builderï¼ˆæ–°æ ¼å¼ï¼‰â­v1.1ä¿®æ”¹
- [ ] æµ‹è¯• Phase 1

### Phase 2: Sheet 3-7 (4å¤©)

**Day 4: Sheet 3 (ä¸Š)**
- [ ] å®ç° traits_collector
- [ ] å®ç° Sheet3Builder
  - [ ] æŒ‰å¹´ä»½æ±‡æ€»è¡¨
  - [ ] NM$åˆ†å¸ƒï¼ˆå›¾è¡¨ï¼‰
  - [ ] TPIåˆ†å¸ƒï¼ˆå›¾è¡¨ï¼‰

**Day 5: Sheet 3 (ä¸‹)**
- [ ] è‚²ç§æŒ‡æ•°æ­£æ€åˆ†å¸ƒ â­v1.1æ–°å¢
- [ ] NM$æ­£æ€åˆ†å¸ƒ
- [ ] TPIæ­£æ€åˆ†å¸ƒ
- [ ] æ€§çŠ¶è¿›å±•æŠ˜çº¿å›¾ï¼ˆå«å¯¹æ¯”ï¼‰â­v1.1ä¿®æ”¹
- [ ] å¯¹æ¯”ç‰§åœºåŠŸèƒ½
- [ ] æ˜ç»†è¡¨

**Day 6: Sheet 4 & 5**
- [ ] å®ç° bull_usage_collector
- [ ] å®ç° Sheet4Builder
  - [ ] æŒ‰å¹´åº¦æ±‡æ€»è¡¨
  - [ ] å„å¹´ä»½æ˜ç»†è¡¨ï¼ˆæ–°æ ¼å¼ï¼‰â­v1.1ä¿®æ”¹
- [ ] å®ç° gene_collector
- [ ] å®ç° Sheet5Builder
  - [ ] æ±‡æ€»è¡¨
  - [ ] åä»£é£é™©é¢„æµ‹ï¼ˆ4çº§ï¼‰â­v1.1ä¿®æ”¹
  - [ ] æ˜ç»†è¡¨ï¼ˆæ–°æ ¼å¼ï¼‰â­v1.1ä¿®æ”¹

**Day 7: Sheet 6, 7, 7A**
- [ ] å®ç° inbreeding_collector
- [ ] å®ç° Sheet6Builder
- [ ] å®ç° bull_ranking_collector
- [ ] å®ç° Sheet7Builderï¼ˆåˆ é™¤å“ç§/å‡ºç”Ÿæ—¥æœŸï¼‰â­v1.1ä¿®æ”¹
- [ ] å®ç° bull_prediction_collector â­v1.1æ–°å¢
- [ ] å®ç° Sheet7ABuilder â­v1.1æ–°å¢

### Phase 3: æµ‹è¯•ä¼˜åŒ– (2å¤©)

**Day 8: é›†æˆæµ‹è¯•**
- [ ] å®Œæ•´æµç¨‹æµ‹è¯•
- [ ] ä¿®å¤bug
- [ ] æ€§èƒ½ä¼˜åŒ–

**Day 9: UIé›†æˆ**
- [ ] ä¸»çª—å£æ·»åŠ æŒ‰é’®
- [ ] è¿›åº¦å¯¹è¯æ¡†
- [ ] é”™è¯¯å¤„ç†
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] èƒ½å¤Ÿç”Ÿæˆå®Œæ•´ç‰ˆæŠ¥å‘Šï¼ˆ9ä¸ªSheetï¼‰
- [ ] Sheet 1: åŒ…å«2ä¸ªé¥¼å›¾
- [ ] Sheet 2: åŒ…å«3ä¸ªé¥¼å›¾
- [ ] Sheet 3: åŒ…å«3ä¸ªæ­£æ€åˆ†å¸ƒå›¾ + æŠ˜çº¿å›¾ï¼ˆå«å¯¹æ¯”ï¼‰
- [ ] Sheet 4: æ˜ç»†è¡¨åŒ…å«"ä½¿ç”¨æ”¯æ•°"åˆ—
- [ ] Sheet 5: 4çº§é£é™©åˆ†ç±» + æ–°æ ¼å¼æ˜ç»†è¡¨
- [ ] Sheet 7: åˆ é™¤å“ç§/å‡ºç”Ÿæ—¥æœŸ
- [ ] Sheet 7A: å¤‡é€‰å…¬ç‰›é¢„æµ‹åˆ†æå®Œæ•´
- [ ] Sheet 8: æ–°æ ¼å¼é€‰é…ç»“æœ
- [ ] æ‰€æœ‰æ ¼å¼æ­£ç¡®
- [ ] ç”Ÿæˆé€Ÿåº¦ < 60ç§’

### ä»£ç è´¨é‡
- [ ] ä»£ç ç»“æ„æ¸…æ™°
- [ ] æ¨¡å—èŒè´£æ˜ç¡®
- [ ] æ—¥å¿—å®Œå–„
- [ ] å¼‚å¸¸å¤„ç†å¥å…¨
- [ ] æ³¨é‡Šå……åˆ†

---

**é¢„è®¡æ€»å¼€å‘æ—¶é—´:** 9å¤©
**å¼€å§‹æ—¥æœŸ:** 2025-10-08
**é¢„è®¡å®Œæˆæ—¥æœŸ:** 2025-10-18

**æœ€åæ›´æ–°:** 2025-10-07
