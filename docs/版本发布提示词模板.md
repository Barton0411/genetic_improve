# 版本发布提示词模板

**核心理念:** 用户只说一句话，AI自动完成所有工作。

**创建时间:** 2025-11-03

---

## 🚀 推荐提示词（直接复制使用）

### ⚡ 方式1：斜杠命令（最简单，需要重启）

```bash
/release v1.2.0.19
```

**如果提示 "Unknown slash command: release"：**
1. 退出并重启 Claude Code（输入 `exit` 然后 `claude`）
2. 重启后命令就能用了

---

### ⭐ 方式2：完整提示词（立即可用，无需重启）

```
发布新版本 v1.2.0.19，清理测试文件，更新所有文档和版本号，提交到GitHub并触发构建
```

**就这一句话！** AI会自动完成以下所有操作：

### 第1步：分析变更内容
- 检查git log（从上个版本标签到现在的所有commit）
- 扫描最近修改的源代码文件
- 自动分类为：新功能、Bug修复、性能改进、其他变更
- 使用今天的日期作为发布日期

### 第2步：扫描需要清理的文件
- 扫描test/目录下的临时文件
- 扫描.log、.tmp、.cache等临时文件
- 查找7天以上未修改的测试数据文件
- **列出文件清单，等待用户确认后删除**

### 第3步：更新所有文档（按维护规则检查清单）
- `docs/05-项目管理/版本历史.md` - 添加新版本条目
- `docs/05-项目管理/已完成任务.md` - 标记完成的任务
- `docs/05-项目管理/项目路线图.md` - 更新任务优先级
- `docs/README.md` - 更新版本号、完成度、功能列表
- `docs/01-快速开始/快速入门指南.md` - 如有重大功能更新
- `docs/01-快速开始/常见问题FAQ.md` - 如有新的常见问题
- `docs/02-用户手册/` - 创建或更新功能文档（如有新功能）
- `docs/03-开发文档/API参考.md` - 如有API变更
- 更新所有修改文档的"更新时间"字段

### 第4步：更新代码版本号
- `version.json` - 更新version字段
- `version.py` - 更新__version__变量
- `core/version.py` - 如存在
- `package.json` - 如存在
- 其他包含版本号的配置文件

### 第5步：执行Git操作
- `git add .` - 添加所有变更
- `git commit -m "Release v1.2.0.19: [自动生成的变更摘要]"` - 提交
- `git tag v1.2.0.19 -m "[完整发布说明]"` - 创建标签
- `git push origin main` - 推送代码（**需用户确认**）
- `git push origin v1.2.0.19` - 推送标签
- 触发GitHub Actions自动构建

### 第6步：生成发布报告
- 列出所有更新的文档（带路径）
- 显示变更内容摘要
- 显示Git操作结果
- 提供下一步建议

---

### 更精简版

```
发布 v1.2.0.19
```

AI会自动分析和更新，但不清理文件、不自动push（等待确认）

---

### Bug修复快速版

```
发布Bug修复版本 v1.2.0.19
```

AI会使用简化流程（只更新版本历史和README）

---

## ❌ 原始提示词的问题

### 您的原始提示词：
```
"接下来我们清理无用的测试文件、更新各个docs文档（实施方案、version.josn、
version.py、history等等关键文档），更新git版本v1.2.0.19，并上传GitHub,
启动GitHub action"
```

### 3个主要问题：

| 问题 | 影响 | 解决方案 |
|-----|------|---------|
| 1. **"各个docs文档"、"等等"太模糊** | AI不知道具体要更新哪些文档，容易遗漏 | AI自动按照维护规则检查清单执行 |
| 2. **没有变更内容** | AI无法准确填写版本历史和更新文档 | AI自动通过git log分析变更 |
| 3. **"无用的测试文件"不明确** | 可能误删重要文件 | AI先列出文件，用户确认后删除 |

---

## 🎯 优化后的效果

### 原始方式（问题多）
```
用户："更新各个docs文档等等，发布v1.2.0.19"
AI  ："好的，我更新了version.json和README"
用户："版本历史呢？项目路线图呢？"
AI  ："抱歉我漏了..."
```

### 优化后（自动完整）
```
用户："发布新版本 v1.2.0.19，清理测试文件，更新所有文档和版本号，提交到GitHub并触发构建"

AI  ："收到！我开始自动分析和执行...

      【变更分析】（自动检查git log）
      - 修复了近交计算Bug
      - 优化了Excel生成性能
      - 更新了文档

      【文档更新】（自动按检查清单）
      ✅ 版本历史.md
      ✅ 已完成任务.md
      ✅ 项目路线图.md
      ✅ 主README.md
      ✅ version.json
      ✅ version.py

      【测试文件清理】
      发现以下文件建议删除：
      - test/data/old_test.xlsx (14天未使用)
      是否删除？

      确认后执行Git操作..."
```

---

## 💡 AI自动识别的内容

### 1. 发布日期 = 今天
- 无需填写，自动使用当前日期

### 2. 变更内容 = Git分析
AI自动执行：
```bash
# 找出上一个版本标签
git describe --tags --abbrev=0

# 分析从上个版本到现在的所有commit
git log v1.2.0.18..HEAD --oneline

# 扫描最近修改的文件
git diff --name-only v1.2.0.18..HEAD
```

然后自动分类为：
- 新功能（feat:开头的commit或新增功能文件）
- Bug修复（fix:开头的commit）
- 性能改进（perf:开头的commit）
- 文档更新（docs:开头的commit）

### 3. 要更新的文档 = 维护规则清单
AI自动按照`docs/文档维护规则.md`中的检查清单执行

### 4. 测试文件 = 智能扫描
AI自动扫描：
- test/目录下的临时文件
- 7天以上未修改的测试数据
- .log、.tmp、.cache等临时文件

**然后列出来让您确认，不会自动删除！**

---

## 🎨 不同场景的提示词

### 场景1：标准大版本发布
```
发布新版本 v1.3.0，清理测试文件，更新所有文档和版本号，提交到GitHub并触发构建
```

### 场景2：小Bug修复
```
发布Bug修复版本 v1.2.0.19
```

### 场景3：只更新文档，不发布
```
更新docs文档到v1.2.0.18版本（补充遗漏的文档更新）
```

### 场景4：紧急热修复（跳过清理）
```
紧急发布 v1.2.0.20，修复线上Bug，跳过测试文件清理
```

---

## 📝 关键原则

### ✅ AI应该自动做的事：
1. 分析git log获取变更内容
2. 使用当前日期作为发布日期
3. 按维护规则检查清单更新所有文档
4. 扫描需要清理的测试文件
5. 生成完整的操作报告

### ❌ AI不应该自动做的事（需要确认）：
1. 删除文件（先列出，用户确认）
2. 推送到GitHub（先commit和tag，用户确认后push）
3. 修改重要配置（先询问）

### ⚠️ AI应该提醒的事：
1. "发现X个文件建议删除，是否确认？"
2. "检测到版本号跨度较大（v1.2→v1.3），是否确认？"
3. "即将推送到GitHub，是否确认？"

---

## 🔧 快速参考

### 一句话版本发布
```
发布 v1.2.0.19，清理测试文件，更新所有文档和版本号，提交到GitHub并触发构建
```

### AI自动完成的完整操作清单

#### 📊 分析阶段
- [ ] 检查git log分析所有commit
- [ ] 扫描修改的源代码文件
- [ ] 分类变更（新功能/Bug修复/改进）
- [ ] 确定发布日期（今天）

#### 🗑️ 清理阶段
- [ ] 扫描test/目录临时文件
- [ ] 扫描.log/.tmp/.cache文件
- [ ] 查找7天未用的测试数据
- [ ] 列出清单给用户确认

#### 📝 文档更新阶段（9个文档位置）
- [ ] `docs/05-项目管理/版本历史.md`
- [ ] `docs/05-项目管理/已完成任务.md`
- [ ] `docs/05-项目管理/项目路线图.md`
- [ ] `docs/README.md`
- [ ] `docs/01-快速开始/快速入门指南.md`（如需要）
- [ ] `docs/01-快速开始/常见问题FAQ.md`（如需要）
- [ ] `docs/02-用户手册/[新功能文档]`（如有新功能）
- [ ] `docs/03-开发文档/API参考.md`（如有API变更）
- [ ] 更新所有文档的"更新时间"字段

#### 🔢 版本号更新阶段
- [ ] `version.json`
- [ ] `version.py`
- [ ] `core/version.py`（如存在）
- [ ] `package.json`（如存在）

#### 📦 Git操作阶段
- [ ] `git add .`
- [ ] `git commit -m "Release v1.2.0.19: [摘要]"`
- [ ] `git tag v1.2.0.19 -m "[说明]"`
- [ ] `git push origin main`（需确认）
- [ ] `git push origin v1.2.0.19`
- [ ] 触发GitHub Actions

#### 📋 报告阶段
- [ ] 列出所有更新的文档
- [ ] 显示变更内容摘要
- [ ] 显示Git操作结果
- [ ] 提供下一步建议

### 用户只需确认2件事
1. ✅ 是否删除列出的测试文件？
2. ✅ 是否推送到GitHub？

---

**最后更新:** 2025-11-03

**下次发布直接复制这句话：**
```
发布新版本 v1.2.0.19，清理测试文件，更新所有文档和版本号，提交到GitHub并触发构建
```

**AI会自动执行上面的完整清单（共30+项操作）！**
