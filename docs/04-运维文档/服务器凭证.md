# 服务器凭证和密钥信息

⚠️ **重要提示**: 此文件包含敏感信息，已添加到 `.gitignore`，请勿提交到Git仓库！

**最后更新:** 2025-10-07

---

## 🔑 SSH密钥

### 阿里云ECS访问密钥
```yaml
密钥文件名: genetic_improvement.pem
存储位置: ~/Downloads/genetic_improvement.pem
权限设置: chmod 600 ~/Downloads/genetic_improvement.pem

服务器信息:
  - 用户名: ecs-user
  - 公网IP: 39.96.189.27
  - 内网IP: 172.23.188.168

连接命令:
  ssh -i ~/Downloads/genetic_improvement.pem ecs-user@39.96.189.27
```

**备份位置记录：**
```
- [ ] 主备份: _______________________________________________
- [ ] 异地备份: _____________________________________________
- [ ] 团队共享位置（如需要）: _______________________________
```

---

## 🗄️ 数据库凭证

### PolarDB MySQL (生产环境)
```yaml
主机: defectgene-new.mysql.polardb.rds.aliyuncs.com
IP: 8.147.221.122
端口: 3306
数据库名: bull_library
用户名: defect_genetic_checking
密码: Jaybz@890411

连接示例:
  mysql -h defectgene-new.mysql.polardb.rds.aliyuncs.com \
        -P 3306 \
        -u defect_genetic_checking \
        -p'Jaybz@890411' \
        bull_library

访问限制:
  - ECS服务器内网: 172.23.188.168
  - 其他授权IP: ___________________________________________
```

### 本地SQLite缓存
```yaml
位置: ~/.genetic_improve/bull_library_cache.db
大小: ~132MB
记录数: 247,192条
用途: 客户端本地缓存
更新方式: 从OSS自动下载
```

---

## ☁️ 阿里云OSS凭证

### OSS访问密钥
```yaml
AccessKey ID: [已通过test_oss_access.py测试验证]
AccessKey Secret: [已通过test_oss_access.py测试验证]

# ⚠️ 请手动填写实际的AccessKey
# ⚠️ RAM子账号: oss-upload-user
# ⚠️ 创建时间: 2025-10-07
# ⚠️ 权限: AliyunOSSFullAccess

Bucket信息:
  - Bucket名称: genetic-improve
  - 区域: 华北2（北京）oss-cn-beijing.aliyuncs.com
  - 权限: 公共读
  - 控制台: https://oss.console.aliyun.com/bucket/oss-cn-beijing/genetic-improve
```

### OSS使用记录
```yaml
当前存储量: ~500MB
主要文件:
  - bull_library.db: 132MB (数据库)
  - 应用安装包: ~250MB/版本

月度费用估算:
  - 存储费用: ¥9.92/月 (100GB套餐 ¥118.99/年)
  - 流量费用: ~¥50/月 (估算100用户)
```

---

## 🔐 API认证密钥

### JWT密钥配置
```yaml
JWT_SECRET_KEY: genetic-improve-api-secret-key
JWT_ALGORITHM: HS256
JWT_EXPIRE_HOURS: 24

⚠️ 安全建议:
  - 生产环境应使用更强的密钥（至少32位随机字符串）
  - 建议定期轮换密钥（建议周期：每年）
  - 下次更换时间: ___________________________________________
```

**生成强密钥命令：**
```bash
# Python方式
python3 -c "import secrets; print(secrets.token_urlsafe(32))"

# OpenSSL方式
openssl rand -base64 32
```

---

## 🌐 域名和DNS

### 域名信息
```yaml
主域名: genepop.com
注册商: Alibaba Cloud Computing Ltd. (阿里云计算有限公司)
注册账号: aliyun77378... (jaybzwang@163.com)
域名持有者: 王波锋
注册日期: 2025-09-16 16:37:36
到期时间: 2030-09-16 16:37:36 (5年有效期)
续费提醒: 提前60天 (2030-07-16)

DNS服务商: dns9.hichina.com
DNS配置:
  类型    主机记录    记录值
  A       @          39.96.189.27
  A       www        39.96.189.27
  A       api        39.96.189.27
```

---

## 🔒 SSL证书

### Let's Encrypt证书
```yaml
证书类型: Let's Encrypt (免费)
域名: api.genepop.com
证书路径: /etc/letsencrypt/live/api.genepop.com/
  - fullchain.pem (完整证书链)
  - privkey.pem (私钥)

有效期: 90天
当前到期时间: 2025-12-15
自动续期: 是 (certbot定时任务)

手动续期命令:
  sudo certbot renew
  sudo systemctl reload nginx
```

---

## 🖥️ 服务器端口配置

### ECS安全组规则
```yaml
入方向规则:
  协议    端口范围    授权对象        说明
  TCP     22         限制IP列表      SSH访问
  TCP     80         0.0.0.0/0      HTTP (重定向到HTTPS)
  TCP     443        0.0.0.0/0      HTTPS

出方向规则:
  协议    端口范围    授权对象        说明
  ALL     ALL        0.0.0.0/0      允许所有出站流量
```

### 内部服务端口
```yaml
认证API: 8081 (仅localhost访问，通过Nginx反向代理)
数据API: 8082 (仅localhost访问，通过Nginx反向代理)

systemd服务:
  - genetic-auth-api.service
  - genetic-data-api.service
```

---

## 👥 GitHub仓库

### 仓库信息
```yaml
仓库地址: https://github.com/Barton0411/genetic_improve
GitHub用户名: Barton0411
Personal Access Token: [已隐藏 - 请在本地保密文件中查看]
Token名称: Genetic Improve OSS Upload
创建时间: 2025-10-07

Token权限范围:
  ✅ repo (完整仓库访问)
  ✅ workflow (GitHub Actions)

Token创建步骤:
  1. Settings → Developer settings → Personal access tokens → Tokens (classic)
  2. Generate new token (classic)
  3. 勾选: repo + workflow
  4. Generate token
  5. 立即复制保存（只显示一次）

GitHub Actions Secrets (需要配置):
  - ALIYUN_ACCESS_KEY_ID (OSS自动上传)
  - ALIYUN_ACCESS_KEY_SECRET (OSS自动上传)

配置位置:
  https://github.com/Barton0411/genetic_improve/settings/secrets/actions

配置方法:
  1. 访问上述网址
  2. 点击 "New repository secret"
  3. Name: ALIYUN_ACCESS_KEY_ID
     Value: [填写OSS AccessKey ID]
  4. 点击 "Add secret"
  5. 重复步骤2-4，添加 ALIYUN_ACCESS_KEY_SECRET
```

---

## 💰 云服务账单

### 阿里云账号
```yaml
账号: aliyun77378... (jaybzwang@163.com)
密码: [请填写]
实名认证: 王波锋

年度费用概览:
  - ECS服务器: ¥99/年 (到期: 2025-12-16)
  - OSS存储: ¥118.99/年
  - 域名: ¥55/年 (已续费至2030-09-16)
  - 估算流量费: ¥600/年
  - 总计: ~¥873/年 (不含域名5年费用)
```

---

## 📋 密钥管理清单

### 已配置密钥
- [x] SSH密钥 (~/Downloads/genetic_improvement.pem)
- [x] 数据库密码 (Jaybz@890411)
- [x] SSL证书 (Let's Encrypt自动管理)
- [ ] OSS访问密钥 (需手动填写上方)
- [ ] GitHub Token (需手动填写上方)

### 密钥轮换计划
```yaml
SSH密钥:
  - 上次更换: _______________________________________________
  - 下次更换: _______________________________________________
  - 轮换周期: 建议每2年

数据库密码:
  - 上次更换: _______________________________________________
  - 下次更换: _______________________________________________
  - 轮换周期: 建议每6个月

JWT密钥:
  - 上次更换: _______________________________________________
  - 下次更换: _______________________________________________
  - 轮换周期: 建议每年
```

---

## 🔒 安全检查清单

### 定期检查项（建议每月）
- [ ] SSH密钥是否正常可用
- [ ] SSL证书是否即将过期（提前30天续期）
- [ ] 数据库是否可正常访问
- [ ] OSS访问密钥是否有效
- [ ] GitHub Actions是否正常运行
- [ ] 服务器磁盘空间是否充足
- [ ] 域名是否即将过期（提前60天续费）
- [ ] 阿里云账单是否正常
- [ ] 安全组规则是否合理
- [ ] 服务器是否有异常登录

### 安全事件处理
```yaml
密钥泄露应急流程:
  1. 立即更换泄露的密钥
  2. 检查是否有异常访问
  3. 通知团队成员
  4. 更新所有使用该密钥的系统
  5. 记录事件和处理过程

联系方式:
  - 技术负责人: ___________________________________________
  - 紧急联系电话: _________________________________________
  - 备用联系人: ___________________________________________
```

---

## 📞 紧急联系信息

### 服务故障联系人
```yaml
阿里云技术支持:
  - 客服电话: 95187
  - 工单系统: https://workorder.console.aliyun.com/

域名注册商:
  - 客服电话: _______________________________________________
  - 联系邮箱: _______________________________________________

项目负责人:
  - 姓名: ___________________________________________________
  - 电话: ___________________________________________________
  - 邮箱: ___________________________________________________
```

### 备用访问方案
```yaml
1. SSH密钥丢失:
   - 方案: 通过阿里云控制台重置密码
   - 控制台: https://ecs.console.aliyun.com/

2. 数据库访问失败:
   - 方案: 检查白名单配置
   - 控制台: https://polardb.console.aliyun.com/

3. 域名解析异常:
   - 方案: 直接使用IP访问 (39.96.189.27)
   - 检查DNS服务商配置

4. SSL证书过期:
   - 方案: 手动续期 sudo certbot renew
   - 临时方案: 使用HTTP访问（不推荐）
```

---

## 📝 维护日志

### 重要操作记录
```
日期: 2025-10-07
操作: 创建此凭证文档
操作人: 开发团队
备注: 初始版本，部分信息待填写

---

日期: ___________
操作: ___________
操作人: ___________
备注: ___________

---

日期: ___________
操作: ___________
操作人: ___________
备注: ___________
```

---

## ⚠️ 重要提醒

1. **定期备份密钥**: 至少在2个不同位置备份SSH密钥
2. **定期检查到期**: 域名、SSL证书、服务器要提前续费
3. **定期轮换密码**: 按照计划定期更换关键密码
4. **监控安全日志**: 定期检查服务器访问日志
5. **保密责任**: 此文档包含敏感信息，严禁泄露

---

**文档维护:** 请在每次更新密钥或配置后及时更新此文档
**最后更新:** 2025-10-07
