# 伊利奶牛选配系统 - 版本更新日志

所有重要的项目变更都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-cn/1.0.0/)，本项目遵循 [语义化版本](https://semver.org/lang/zh-CN/) 规范。

## [1.0.9.14] - 2025-09-17

### 🔧 修复
- 修正强制更新对话框关闭行为逻辑
- 关闭更新窗口现在正确退出整个程序，而不是跳过更新

### 📝 界面改进
- 更新确认对话框提示信息，明确说明关闭将退出程序
- 澄清强制更新的正确行为：必须更新或选择退出程序

### 🎯 行为调整
- 强制更新对话框关闭 = 退出整个应用程序
- 优化程序退出逻辑，确保资源正确释放
- 用户无法在不更新的情况下继续使用程序

### 💡 逻辑澄清
- 强制更新只有两个选择：立即更新 或 退出程序
- 移除了"跳过更新继续使用"的误导性描述

## [1.0.9.13] - 2025-09-17

### ✨ 新增功能
- 为强制更新对话框添加关闭按钮
- 支持ESC键关闭对话框（需确认）
- 增加关闭确认机制，防止意外跳过重要更新

### 🎯 用户体验改进
- 优化用户操作选择，提供更多灵活性
- 改进关闭提示信息，详细说明跳过更新的风险
- 确保用户在充分了解风险的情况下做出选择

### 🔒 安全考虑
- 保持强制更新的重要性，但给予用户最终选择权
- 在用户选择跳过更新时记录日志，便于追踪
- 防止下载线程泄漏，确保资源正确释放

## [1.0.9.12] - 2025-09-17

### 🔍 新增功能
- 增强版本更新检查日志记录系统
- 添加详细的版本检查流程跟踪
- 新增平台检测信息输出
- 实现全流程调试输出标记

### 🐛 问题修复
- 修复Windows平台版本检查问题诊断
- 优化版本管理器初始化流程
- 改进错误信息和调试输出
- 增强异常处理和错误报告

### 🛠️ 技术改进
- 添加开始和结束日志标记便于问题定位
- 完善异常捕获和堆栈跟踪记录
- 优化版本比较逻辑的日志输出
- 增强网络连接和API响应的调试信息

### 📝 文档更新
- 更新README.md至最新版本信息
- 完善安装指南和系统要求
- 更新GitHub仓库链接
- 新增CHANGELOG.md变更日志

## [1.0.9.11] - 2025-09-17

### 🔥 重大变更
- macOS改为手动拖拽安装，避免应用崩溃
- 移除自动删除复制逻辑，防止应用包损坏
- 利用macOS原生应用替换机制

### ✨ 新增功能
- 简化安装流程，提升用户体验
- 保持DMG挂载状态便于用户操作
- 优化手动安装指导显示

### 🔒 安全修复
- 修复QtCore模块内存访问崩溃问题
- 增强应用安装过程的稳定性

### 🚀 构建优化
- 同时支持Windows和macOS平台打包
- 优化GitHub Actions构建流程

## [1.0.9.10] - 2025-09-17

### 🔥 重大功能
- 完整实现应用内自动更新系统
- 真实下载功能替代模拟进度条
- 智能DMG挂载和应用识别机制

### 🎯 智能化改进
- 通用应用名称识别，无需硬编码
- 多重安全验证避免误操作其他应用
- 支持完全自动安装和重启

### 🌙 界面优化
- 修复暗色模式下手动安装指导显示问题
- 优化用户交互体验

### 🚀 系统验证
- 端到端自动更新流程验证完成
- 完善的更新机制测试

## [1.0.6] - 2025-09-16

### 🔥 强制更新系统
- 实现强制更新系统，确保关键更新必须安装
- 新增应用内智能更新功能，无需手动下载安装包
- 增强更新安全性，支持完整文件替换和回滚机制

### 🎨 用户界面
- 全新设计的更新对话框，支持深色/浅色模式自动适配
- 智能路径检测，支持任意安装位置的程序更新

### 🔒 数据保护
- 保护用户数据，更新过程中项目文件和配置安全不受影响
- 三阶段更新流程：准备→执行→验证，确保更新可靠性

### 💻 跨平台支持
- 跨平台兼容，完美支持Windows、macOS和Linux系统

## [1.0.5.2] - 2025-09-16

### ⚖️ 算法调整
- 调整近交系数默认阈值从3.125%改为6.25%
- 优化选配约束条件，提供更多选配组合

### 🖥️ 界面优化
- 更新GUI界面默认选择为6.25%阈值
- 完善个体选配和完整选配的默认参数

## [1.0.5.1] - 2025-09-16

### 🧪 测试验证
- 测试GitHub Actions自动构建流程
- 验证强制更新系统完整功能
- OSS自动扫描API集成测试

### 📊 自动化部署
- 自动生成changelog并上传到OSS
- 端到端自动化部署流程验证

## [1.0.5] - 2025-09-16

### ✨ 版本更新系统
- 完善版本自动更新系统，支持GUI对话框选择下载
- 修复版本检查服务器连接逻辑，增加备用服务器支持
- 优化下载URL获取机制，直接从版本信息API响应中提取

### 🔄 技术优化
- 更新PyQt6更新对话框，替换原有tkinter实现避免崩溃
- 更新全面的系统文档和部署指南
- 优化requirements.txt依赖版本和兼容性

### 🔒 安全准备
- 为明日API化数据库连接做准备，提升安全性

## [1.0.4] - 2025-09-15

### ⚡ 性能优化
- 优化个体选配报告生成性能，添加约束数据缓存机制
- 大幅提升报告生成速度，减少文件I/O操作

### ✨ 功能增强
- 实现选配备注系统，详细说明约束过滤情况
- 新增近交系数和隐性基因约束分析功能
- 增强约束分析准确性，支持跳过优质公牛的详细说明

### 🐛 问题修复
- 修复备注格式，去除冗余前缀文字

## [1.0.3] - 2025-08-27

### 🐛 重要修复
- 修复后代近交系数排序问题，优先按后代近交系数降序排序
- 修复血缘图滚轮缩放时图形消失问题，添加缩放边界检查
- 修复缩放中心固定为血缘图正中心，防止图形移动

### ✨ 新增功能
- 添加代数选择按钮，支持2-6代血缘图显示
- 禁止缩放血缘图标题，保持标题大小固定
- 扩展代数选择范围为2-6代，字体大小自动适配框的大小

### 🎨 界面优化
- 增大血缘图字体大小，提高可读性
- 降低滚轮缩放敏感度，减少单次缩放幅度
- 完全禁用简易系谱图的拖动功能，只保留双击查看详细视图
- 移除适应内容按钮，简化用户界面

## [1.0.2] - 2025-08-08

### 🧬 算法优化
- 优化冻精分配算法，先给排名高的母牛分配排名高的公牛
- 加载公牛指数得分用于计算后代得分
- 根据后代得分排序公牛，确保高分母牛优先获得高分公牛

### 🐛 界面修复
- 修复冻精预览表列宽问题，冻精编号显示完整

### ✨ 功能增强
- 添加育种项目管理文件双击打开和右键菜单功能

## [1.0.1] - 2025-07-29

### 🚀 PPT生成重大改进
- 重大改进PPT生成功能
- 新增母牛关键性状详情分析页
- 新增公牛育种指数排名页
- 新增年度遗传进展趋势页
- 新增近交系数风险分析页
- 新增隐性基因筛查统计页
- 新增选配推荐详情示例页
- 新增项目总结与改良建议页

### 🎨 界面优化
- 优化PPT页面布局和数据展示
- 增强PPT内容的完整性和专业性

### 🔧 技术修复
- 修复数据库DNS解析问题，使用IP地址直连
- 更新requirements.txt，添加所有缺失的依赖项
- 修复opencv-python、networkx、scikit-learn依赖缺失问题

## [1.0.0] - 2025-07-28

### 🎉 初始版本发布
- 实现育种项目管理功能
- 实现数据上传功能（母牛、公牛、配种记录、体型外貌、基因组数据）
- 实现关键育种性状分析
- 实现牛只指数计算排名
- 实现近交系数及隐性基因分析
- 实现个体选配功能
- 实现选配推荐报告生成（包含后代得分预测）
- 实现PPT自动报告生成
- 集成阿里云数据库
- 优化UI界面和用户体验

---

## 版本规则说明

### 版本号格式
- 格式：`主版本号.次版本号.修订号.构建号` (例如: 1.0.9.12)
- **主版本号**: 重大架构变更或功能重构
- **次版本号**: 新功能添加或重要改进
- **修订号**: 问题修复和小幅优化
- **构建号**: 日常构建和测试版本

### 更新类型
- 🔥 **重大变更**: 架构级别的重要更新
- ✨ **新增功能**: 全新功能模块
- ⚡ **性能优化**: 性能和效率提升
- 🐛 **问题修复**: Bug修复和错误纠正
- 🎨 **界面优化**: UI/UX改进
- 🔒 **安全修复**: 安全相关的修复
- 📝 **文档更新**: 文档和注释改进
- 🔧 **技术改进**: 代码质量和维护性提升
- 🚀 **构建优化**: 构建和部署流程改进

### 发布周期
- **稳定版本**: 每月发布，包含完整测试
- **修复版本**: 按需发布，快速修复关键问题
- **测试版本**: 每周发布，用于内部测试和验证