"""
版本信息管理
"""

# 版本号格式: 主版本号.次版本号.修订号.构建号 (xxx.xxx.xxx.xxx)
VERSION = "1.2.0.17"

# 版本历史（仅保留最近15个版本）
VERSION_HISTORY = [
    {
        "version": "1.2.0.17",
        "date": "2025-11-01",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：修正Sheet 3-2/3-3/4整体正态分布图统计表缺失问题",
            "2. <b>优化</b>：统计表格式转置，指标作为列，分组作为行，与其他统计表格式统一",
            "3. <b>优化</b>：五等份分析表转置，分组作为列，指标作为行，提高可读性",
            "4. <b>优化</b>：正态分布图Y轴范围动态调整为曲线最高点的2倍",
            "5. <b>功能</b>：统计表新增最小值、最大值指标",
            "6. <b>功能</b>：添加详细指标说明和分析建议（变异系数、Q1-Q3等）",
            "7. <b>优化</b>：正态分布图X轴范围基于每个图表数据动态计算"
        ]
    },
    {
        "version": "1.2.0.16",
        "date": "2025-10-31",
        "author": "Development Team",
        "changes": [
            "1. <b>功能</b>：Sheet 10表头国际化，使用系统标准翻译",
            "2. <b>优化</b>：进度条平滑动画，每50ms更新一次",
            "3. <b>优化</b>：进度条持续移动，避免卡住不动",
            "4. <b>优化</b>：数据收集阶段细分为9个步骤报告进度",
            "5. <b>优化</b>：Sheet 1A复制过程每100行报告一次进度",
            "6. <b>界面</b>：进度对话框窗口置顶显示",
            "7. <b>修复</b>：修正技术标准配置，FE/RFI正确区分",
            "8. <b>修复</b>：修正性状翻译，使用标准术语",
            "9. <b>修复</b>：修正数据库查询，FE数据正确从数据库补充",
            "10. <b>功能</b>：备选公牛排名包含所有技术标准性状"
        ]
    },
    {
        "version": "1.2.0.15",
        "date": "2025-10-29",
        "author": "Development Team",
        "changes": [
            "1. <b>界面</b>：优化导航栏配色方案，提升视觉体验",
            "2. <b>界面</b>：改进菜单选中状态显示效果",
            "3. <b>修复</b>：修复Excel报告中图表重叠显示问题",
            "4. <b>优化</b>：优化散点图布局排列方式"
        ]
    },
    {
        "version": "1.2.0.14",
        "date": "2025-10-28",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：修复数据ID格式问题，解决自动转换导致的错误",
            "2. <b>修复</b>：修复多个核心模块的数据处理逻辑",
            "3. <b>优化</b>：统一数据读取后的格式转换，确保一致性",
            "4. <b>修复</b>：修复数据合并操作中的类型转换问题",
            "5. <b>优化</b>：改进系谱分析为动态年份分组",
            "6. <b>功能</b>：系谱识别结果自动显示最近4年数据",
            "7. <b>修复</b>：彻底解决选配过程中ID格式匹配失败问题"
        ]
    },
    {
        "version": "1.2.0.13",
        "date": "2025-10-18",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：修复非标准NAAB号被清空的问题，保留原始编号",
            "2. <b>优化</b>：优化编号格式化功能，确保配种记录完整",
            "3. <b>功能</b>：添加标准和非标准编号统计输出",
            "4. <b>修复</b>：修复年份分组逻辑，改为动态使用当前年份",
            "5. <b>修复</b>：修复新年份出生牛只不显示的问题",
            "6. <b>功能</b>：新增Sheet 8公牛性状汇总分析报告",
            "7. <b>功能</b>：实现动态性状数据收集功能",
            "8. <b>优化</b>：支持动态识别所有性状列"
        ]
    },
    {
        "version": "1.2.0.12",
        "date": "2025-10-12",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：修复配种记录处理中配种日期丢失问题",
            "2. <b>优化</b>：优化数据填充操作，保护日期列完整性",
            "3. <b>功能</b>：确保配种数据中的日期完整保留"
        ]
    },
    {
        "version": "1.2.0.11",
        "date": "2025-10-12",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：修复所有选配模块的数据列引用错误",
            "2. <b>修复</b>：完全移除旧数据列支持，统一使用新标准",
            "3. <b>修复</b>：修复6个核心模块的选配逻辑",
            "4. <b>优化</b>：简化代码，移除向后兼容逻辑",
            "5. <b>功能</b>：选配功能恢复正常运行",
            "6. <b>优化</b>：清理测试文件，提升代码整洁度",
            "7. <b>界面</b>：修复分析完成弹窗按钮样式不一致问题"
        ]
    },
    {
        "version": "1.2.0.9",
        "date": "2025-10-12",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：核心修复库存管理系统数据结构",
            "2. <b>功能</b>：支持同一公牛多种冻精类型的库存独立管理",
            "3. <b>优化</b>：删除冗余数据列，统一类型标识",
            "4. <b>优化</b>：优化数据预览逻辑，保留所有数据组合",
            "5. <b>功能</b>：使用精确匹配更新库存数据",
            "6. <b>功能</b>：优化分配逻辑，分离库存和遗传数据查询",
            "7. <b>修复</b>：修复数据覆盖导致的库存丢失问题",
            "8. <b>修复</b>：修复类型与库存不匹配的分配错误"
        ]
    },
    {
        "version": "1.2.0.8",
        "date": "2025-10-11",
        "author": "Development Team",
        "changes": [
            "1. <b>功能</b>：完成Excel报告Sheet 5-7生成功能",
            "2. <b>功能</b>：新增配种记录隐性基因分析报告",
            "3. <b>功能</b>：新增配种记录近交系数分析报告",
            "4. <b>功能</b>：新增配种记录详细数据明细报告",
            "5. <b>界面</b>：优化图表颜色，与风险等级对应",
            "6. <b>功能</b>：优化年份趋势表，区分不同风险等级",
            "7. <b>优化</b>：自动化生成页面优化，智能刷新数据列表",
            "8. <b>文档</b>：更新报告生成实施方案文档",
            "9. <b>修复</b>：修复近交系数区间定义"
        ]
    },
    {
        "version": "1.2.0.7",
        "date": "2025-10-10",
        "author": "Development Team",
        "changes": [
            "1. <b>界面</b>：新增对比数据摘要列，显示关键信息",
            "2. <b>功能</b>：优化对比牧场摘要显示格式",
            "3. <b>功能</b>：优化外部参考数据摘要格式",
            "4. <b>修复</b>：修复对比牧场编辑后列表不更新问题",
            "5. <b>修复</b>：修复配置文件缓存不同步问题",
            "6. <b>功能</b>：新增确认按钮，优化操作流程",
            "7. <b>界面</b>：统一确认和关闭按钮样式",
            "8. <b>功能</b>：新增表格双击编辑功能",
            "9. <b>优化</b>：性状值自动保留2位小数",
            "10. <b>优化</b>：优化数据加载逻辑，自动刷新缓存"
        ]
    },
    {
        "version": "1.2.0.6",
        "date": "2025-10-09",
        "author": "Development Team",
        "changes": [
            "1. <b>功能</b>：新增外部参考数据对比功能",
            "2. <b>功能</b>：新增外部参考数据标准模板",
            "3. <b>界面</b>：优化对比牧场管理界面",
            "4. <b>优化</b>：重构报告生成页面，统一管理对比数据",
            "5. <b>功能</b>：支持自定义对比线颜色",
            "6. <b>功能</b>：内置外部参考数据模板",
            "7. <b>修复</b>：修复对比数据加载问题，增强稳定性"
        ]
    },
    {
        "version": "1.2.0.5",
        "date": "2025-10-07",
        "author": "Development Team",
        "changes": [
            "1. <b>文档</b>：建立完整的文档体系",
            "2. <b>功能</b>：优化缺失公牛上传功能",
            "3. <b>界面</b>：简化用户提示信息",
            "4. <b>功能</b>：新增数据库版本显示",
            "5. <b>优化</b>：统一API服务地址",
            "6. <b>文档</b>：创建项目路线图",
            "7. <b>文档</b>：完成已完成任务清单",
            "8. <b>文档</b>：创建待办事项清单",
            "9. <b>优化</b>：整理文档目录结构"
        ]
    },
    {
        "version": "1.2.0.4",
        "date": "2025-09-30",
        "author": "Development Team",
        "changes": [
            "1. <b>修复</b>：修复母牛分配问题，统一ID字段类型",
            "2. <b>界面</b>：优化深色模式支持",
            "3. <b>功能</b>：新增主题管理器",
            "4. <b>修复</b>：修复自动分组对话框显示问题",
            "5. <b>界面</b>：优化深色模式下的文本颜色显示",
            "6. <b>性能</b>：改进程序启动流程",
            "7. <b>修复</b>：修复按钮样式在不同主题下的问题",
            "8. <b>界面</b>：优化预览表格的主题适配"
        ]
    },
    {
        "version": "1.2.0.3",
        "date": "2025-09-27",
        "author": "Development Team",
        "changes": [
            "1. <b>功能</b>：新增分组模式切换功能",
            "2. <b>优化</b>：优化累积报告更新逻辑",
            "3. <b>功能</b>：新增选配预览未分配数量实时更新",
            "4. <b>功能</b>：新增清空选配功能",
            "5. <b>修复</b>：修复数字分组显示问题",
            "6. <b>修复</b>：修复空组不显示问题",
            "7. <b>修复</b>：修复自动分组显示问题",
            "8. <b>修复</b>：修复清空选配时列名错误",
            "9. <b>功能</b>：选配后自动更新分组预览统计",
            "10. <b>优化</b>：改进组别替换逻辑"
        ]
    },
    {
        "version": "1.2.0.2",
        "date": "2025-09-22",
        "author": "Development Team",
        "changes": [
            "1. <b>性能</b>：数据库下载全面迁移到云存储",
            "2. <b>优化</b>：移除中间服务器依赖，直接下载数据",
            "3. <b>功能</b>：实现数据库版本管理",
            "4. <b>功能</b>：新增数据库下载进度条",
            "5. <b>功能</b>：实现下载失败自动重试机制",
            "6. <b>优化</b>：优化文件组织结构",
            "7. <b>优化</b>：日志文件独立目录管理",
            "8. <b>修复</b>：修复版本文件初始化问题",
            "9. <b>优化</b>：优化版本文件管理机制",
            "10. <b>修复</b>：修复边界情况处理",
            "11. <b>优化</b>：构建流程优化"
        ]
    },
    {
        "version": "1.2.0.1",
        "date": "2025-09-22",
        "author": "Development Team",
        "changes": [
            "1. <b>性能</b>：选配算法优化",
            "2. <b>修复</b>：修复公牛育种指数加载问题",
            "3. <b>功能</b>：选配时使用用户计算的育种指数",
            "4. <b>优化</b>：改进错误提示系统",
            "5. <b>优化</b>：优化文件缺失错误消息",
            "6. <b>优化</b>：移除选配过程中的外部依赖",
            "7. <b>功能</b>：完善用户自定义育种指数加载",
            "8. <b>功能</b>：增强云数据库连接",
            "9. <b>性能</b>：优化数据库同步性能"
        ]
    },
    {
        "version": "1.1.2.0",
        "date": "2025-09-21",
        "author": "Development Team",
        "changes": [
            "1. <b>界面</b>：实现缺失公牛数据的预估值标记功能",
            "2. <b>功能</b>：Excel报告中添加数据质量视觉标识",
            "3. <b>优化</b>：优化育种值计算逻辑",
            "4. <b>功能</b>：实现遗传趋势分析和线性插值",
            "5. <b>功能</b>：添加完整格式标记",
            "6. <b>功能</b>：所有公牛性状列支持源数据标记",
            "7. <b>性能</b>：简化计算流程，提升数据处理性能",
            "8. <b>界面</b>：改进数据质量可视化"
        ]
    }
]

# 获取当前版本
def get_version():
    """获取当前版本号"""
    return VERSION

# 获取版本信息
def get_version_info():
    """获取当前版本的完整信息"""
    for v in VERSION_HISTORY:
        if v["version"] == VERSION:
            return v
    # 如果没找到，返回第一个（最新的）
    if VERSION_HISTORY:
        return VERSION_HISTORY[0]
    return None

# 获取版本历史
def get_version_history():
    """获取所有版本历史"""
    return VERSION_HISTORY
